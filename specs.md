# Спецификация модулей приложения TaskManager

## Модуль: data.py - Хранение и загрузка задач

Модуль отвечает за работу с файловым хранилищем данных в формате JSON.

### Функция: load_tasks()

**Назначение**: Загружает список задач из файла tasks.json

**Входные параметры**: Нет

**Возвращаемое значение**: `List[dict]` - список словарей, каждый словарь представляет задачу

**Описание**:
- Читает файл `tasks.json` из текущей директории с использованием UTF-8 кодировки
- Если файл существует и содержит валидный JSON - парсит его и возвращает список задач
- Если файл не существует - возвращает пустой список `[]`
- Если файл существует, но содержит невалидный JSON - обрабатывает исключение и возвращает пустой список `[]`

**Структура данных задачи**:
```python
{
    "id": int,           # Уникальный идентификатор задачи
    "name": str,         # Название задачи
    "description": str,   # Описание задачи (может быть пустой строкой)
    "status": str        # Статус: "новая", "в работе", "завершена"
}
```

**Пример использования**:
```python
tasks = load_tasks()
# Возвращает: [{"id": 1, "name": "Задача 1", "description": "Описание", "status": "новая"}]
```

**Обработка ошибок**:
- `FileNotFoundError`: возвращает `[]`
- `json.JSONDecodeError`: возвращает `[]` или выводит предупреждение

---

### Функция: save_tasks(tasks)

**Назначение**: Сохраняет список задач в файл tasks.json

**Входные параметры**:
- `tasks` (List[dict]): Список словарей с задачами для сохранения

**Возвращаемое значение**: `None`

**Описание**:
- Принимает список задач в виде списка словарей
- Сериализует список в JSON-формат с отступами (indent=4) для читаемости
- Использует UTF-8 кодировку и ensure_ascii=False для корректного отображения кириллицы
- Записывает данные в файл `tasks.json` в текущей директории
- Если файл не существует - создает его
- Если файл существует - перезаписывает его

**Пример использования**:
```python
tasks = [
    {"id": 1, "name": "Задача 1", "description": "Описание", "status": "новая"}
]
save_tasks(tasks)
# Создает/обновляет файл tasks.json
```

**Обработка ошибок**:
- `PermissionError`: выводит сообщение об ошибке доступа к файлу
- `OSError`: выводит сообщение об ошибке записи

---

## Модуль: ui.py - Пользовательский интерфейс

Модуль отвечает за взаимодействие с пользователем через консольный интерфейс.

### Функция: show_menu()

**Назначение**: Отображает главное меню приложения и возвращает выбранный пользователем пункт

**Входные параметры**: Нет

**Возвращаемое значение**: `str` - строка с выбранным пунктом меню (например, "1", "2", "q")

**Описание**:
- Выводит на экран главное меню с доступными опциями:
  - Добавить задачу
  - Просмотреть список задач
  - Изменить статус задачи
  - Редактировать задачу
  - Удалить задачу
  - Массовое удаление задач
  - Выход
- Запрашивает ввод от пользователя
- Валидирует ввод (проверяет, что выбран допустимый пункт меню)
- При неверном вводе выводит сообщение и запрашивает повторный ввод
- Возвращает строку с выбранным пунктом

**Пример использования**:
```python
choice = show_menu()
# Выводит меню и возвращает, например, "1" или "q"
```

**Обработка ошибок**:
- Неверный ввод: выводит сообщение "Неверный выбор. Попробуйте снова." и запрашивает повторный ввод

---

### Функция: get_task_input()

**Назначение**: Запрашивает у пользователя данные для создания новой задачи

**Входные параметры**: Нет

**Возвращаемое значение**: `dict` - словарь с полями задачи:
```python
{
    "name": str,         # Название задачи
    "description": str   # Описание задачи (может быть пустой строкой)
}
```

**Описание**:
- Запрашивает у пользователя название задачи (обязательное поле)
- Если название пустое - запрашивает повторно с сообщением об ошибке
- Запрашивает описание задачи (опциональное поле, может быть пустым)
- Возвращает словарь с введенными данными

**Пример использования**:
```python
task_data = get_task_input()
# Запрашивает ввод и возвращает, например:
# {"name": "Сдать проект", "description": "До 15 декабря"}
```

**Обработка ошибок**:
- Пустое название: выводит сообщение "Название задачи не может быть пустым." и запрашивает повторный ввод

---

### Дополнительные функции модуля ui.py

#### Функция: display_tasks(tasks)

**Назначение**: Отображает список задач в читаемом формате

**Входные параметры**:
- `tasks` (List[dict]): Список задач для отображения

**Возвращаемое значение**: `None`

**Описание**:
- Форматирует и выводит список задач на экран
- Для каждой задачи отображает: ID, название, описание, статус
- Если список пуст - выводит сообщение "Список задач пуст."

---

#### Функция: get_task_ids()

**Назначение**: Запрашивает у пользователя ID задач (одного или нескольких)

**Входные параметры**: Нет

**Возвращаемое значение**: `List[int]` - список ID задач

**Описание**:
- Запрашивает ввод ID задач через пробел
- Преобразует строку в список целых чисел
- Возвращает список ID для обработки

---

#### Функция: get_new_status()

**Назначение**: Запрашивает у пользователя новый статус задачи

**Входные параметры**: Нет

**Возвращаемое значение**: `str` - статус задачи ("новая", "в работе", "завершена")

**Описание**:
- Отображает доступные статусы
- Запрашивает выбор статуса
- Валидирует ввод
- Возвращает выбранный статус

---

## Модуль: logic.py - Бизнес-логика

Модуль содержит бизнес-логику приложения: операции с задачами.

### Функция: add_task(tasks, task_data)

**Назначение**: Добавляет новую задачу в список задач

**Входные параметры**:
- `tasks` (List[dict]): Текущий список задач
- `task_data` (dict): Словарь с данными новой задачи:
  ```python
  {
      "name": str,         # Название задачи
      "description": str   # Описание задачи
  }
  ```

**Возвращаемое значение**: `None` (изменяет список tasks in-place) или обновленный список

**Описание**:
- Генерирует уникальный ID для новой задачи:
  - Если список tasks пуст - ID = 1
  - Если список не пуст - ID = max(существующие ID) + 1
- Создает новую задачу со структурой:
  ```python
  {
      "id": int,           # Сгенерированный ID
      "name": str,         # Из task_data["name"]
      "description": str,  # Из task_data["description"]
      "status": "новая"    # Статус по умолчанию
  }
  ```
- Добавляет задачу в список tasks
- Не возвращает значение (изменяет список in-place) или возвращает обновленный список

**Пример использования**:
```python
tasks = []
task_data = {"name": "Сдать проект", "description": "До 15 декабря"}
add_task(tasks, task_data)
# tasks теперь содержит: [{"id": 1, "name": "Сдать проект", "description": "До 15 декабря", "status": "новая"}]
```

**Обработка ошибок**:
- Если task_data не содержит обязательных полей - выводит сообщение об ошибке

---

### Функция: change_status(tasks, task_id, new_status)

**Назначение**: Изменяет статус задачи по её ID

**Входные параметры**:
- `tasks` (List[dict]): Список задач
- `task_id` (int): ID задачи, статус которой нужно изменить
- `new_status` (str): Новый статус ("новая", "в работе", "завершена")

**Возвращаемое значение**: `bool` - True при успешном изменении, False если задача не найдена

**Описание**:
- Ищет задачу с указанным task_id в списке tasks
- Если задача найдена:
  - Обновляет поле "status" на new_status
  - Возвращает True
- Если задача не найдена:
  - Возвращает False
  - Может вывести сообщение об ошибке

**Пример использования**:
```python
tasks = [{"id": 1, "name": "Задача", "description": "", "status": "новая"}]
success = change_status(tasks, 1, "в работе")
# success = True
# tasks[0]["status"] теперь "в работе"
```

**Обработка ошибок**:
- Задача не найдена: возвращает False
- Неверный статус: может вывести предупреждение, но все равно изменит статус

---

### Дополнительные функции модуля logic.py

#### Функция: edit_task(tasks, task_id, task_data)

**Назначение**: Редактирует название и описание задачи

**Входные параметры**:
- `tasks` (List[dict]): Список задач
- `task_id` (int): ID задачи для редактирования
- `task_data` (dict): Словарь с новыми данными задачи:
  ```python
  {
      "name": str,         # Новое название задачи
      "description": str   # Новое описание задачи
  }
  ```

**Возвращаемое значение**: `bool` - True при успешном редактировании, False если задача не найдена

**Описание**:
- Ищет задачу с указанным task_id
- Если задача найдена - обновляет поля "name" и "description" из task_data
- Возвращает True при успехе, False если задача не найдена

---

#### Функция: delete_task(tasks, task_id)

**Назначение**: Удаляет задачу по ID

**Входные параметры**:
- `tasks` (List[dict]): Список задач
- `task_id` (int): ID задачи для удаления

**Возвращаемое значение**: `bool` - True при успешном удалении, False если задача не найдена

**Описание**:
- Ищет задачу с указанным task_id в списке tasks
- Если задача найдена - удаляет её из списка
- Возвращает True при успехе, False если задача не найдена

---

#### Функция: bulk_delete_tasks(tasks, task_ids)

**Назначение**: Массовое удаление задач по списку ID

**Входные параметры**:
- `tasks` (List[dict]): Список задач
- `task_ids` (List[int]): Список ID задач для удаления

**Возвращаемое значение**: `bool` - True при успешном удалении, False при ошибке

**Описание**:
- Удаляет из списка tasks все задачи, чьи ID присутствуют в task_ids
- Использует функцию delete_task() для каждого ID
- Возвращает True при успехе, False при ошибке

---

## Модуль: main.py - Главное приложение

Модуль содержит главную функцию приложения, которая интегрирует все модули.

### Функция: main()

**Назначение**: Главная функция приложения, реализующая основной цикл работы

**Входные параметры**: Нет

**Возвращаемое значение**: `None`

**Описание**:
- Загружает задачи из файла при запуске через `load_tasks()`
- Реализует основной цикл приложения:
  - Отображает меню через `show_menu()`
  - Обрабатывает выбор пользователя
  - Выполняет соответствующие операции через модули `logic.py` и `ui.py`
  - Сохраняет изменения после каждой операции через `save_tasks()`
- При выходе (выбор пункта "7") завершает работу

**Обработка операций**:
- `1` - Просмотр списка задач (display_tasks)
- `2` - Добавление задачи (get_task_input → add_task → save_tasks)
- `3` - Изменение статуса (get_task_ids → get_new_status → change_status → save_tasks)
- `4` - Редактирование задачи (get_task_ids → get_task_input → edit_task → save_tasks)
- `5` - Удаление задачи (get_task_ids → delete_task → save_tasks)
- `6` - Массовое удаление (get_task_ids → bulk_delete_tasks → save_tasks)
- `7` - Выход из приложения

---

## Взаимодействие модулей

### Типичный поток выполнения:

1. **main.py** → `load_tasks()` из `data.py` - загружает задачи при запуске
2. **main.py** → `show_menu()` из `ui.py` - отображает меню, получает выбор пользователя
3. **main.py** → функции из `ui.py` - получает данные от пользователя
4. **main.py** → функции из `logic.py` - выполняет операцию (add_task, change_status, etc.)
5. **main.py** → `save_tasks()` из `data.py` - сохраняет изменения
6. **main.py** → функции из `ui.py` - отображает результат пользователю

### Зависимости:

- `main.py` зависит от `ui.py`, `logic.py` и `data.py`
- `ui.py` не зависит от других модулей (только стандартная библиотека)
- `logic.py` не зависит от других модулей (работает только с данными)
- `data.py` не зависит от других модулей (работает только с файлом)

